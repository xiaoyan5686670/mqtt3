# STM32_4 温度监控模块 - 可视化示意

## 页面布局示意图

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        MQTT IoT 管理系统                                 │
│                        设备仪表板                                        │
└─────────────────────────────────────────────────────────────────────────┘

┌────────────────┐  ┌────────────────┐  ┌────────────────┐
│   总设备数     │  │   在线设备     │  │   离线设备     │
│      12       │  │       8       │  │       4       │
└────────────────┘  └────────────────┘  └────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│  🔍 搜索设备名称、位置或类型...                                          │
└─────────────────────────────────────────────────────────────────────────┘

╔═════════════════════════════════════════════════════════════════════════╗
║  🌡️ stm32_4 - 温度监控                              【新增模块】        ║
╠═════════════════════════════════════════════════════════════════════════╣
║                                                                         ║
║  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
║  │  🌀 旋转     │  │  🌀 旋转     │  │  🛑 停止     │  │  🌀 旋转     │
║  │              │  │              │  │              │  │              │
║  │  压缩机1入口  │  │  压缩机2入口  │  │  压缩机2出口  │  │  压缩机1出口  │
║  │  温度        │  │  温度        │  │  温度        │  │  温度        │
║  │              │  │              │  │              │  │              │
║  │   75.0 °F   │  │   78.5 °F   │  │   92.0 °F   │  │   80.2 °F   │
║  │   (绿色)     │  │   (绿色)     │  │  (红色闪烁)   │  │   (绿色)     │
║  │              │  │              │  │              │  │              │
║  │  ✓ 正常      │  │  ✓ 正常      │  │  ⚠ 异常      │  │  ✓ 正常      │
║  └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
║                                                                         ║
╚═════════════════════════════════════════════════════════════════════════╝

┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
│  • 在线      │  │  • 在线      │  │  • 离线      │  │  • 在线      │
│  device_1    │  │  device_2    │  │  device_3    │  │  device_4    │
│  温度: 25°C  │  │  湿度: 60%   │  │  温度: --    │  │  温度: 23°C  │
│  湿度: 55%   │  │  温度: 24°C  │  │  湿度: --    │  │  湿度: 58%   │
└──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
```

## 温度卡片详细设计

### 正常状态卡片

```
┌─────────────────────────────────────┐
│  ┏━━━━━┓                            │  ← 绿色边框 (#10b981)
│  ┃ 🌀  ┃  压缩机1入口温度            │  ← 风扇持续旋转
│  ┗━━━━━┛  Comp1 In Temp            │  ← 传感器名称
│                                     │
│         75.0 °F                    │  ← 温度值（绿色 #10b981）
│                                     │  ← 单位（灰色）
│                                     │
│       ┌─────────────┐               │
│       │  ✓  正常    │               │  ← 状态标签（绿色背景）
│       └─────────────┘               │
└─────────────────────────────────────┘
    ↑ 淡绿色渐变背景 (#f0fdf4 → #ffffff)
```

### 异常状态卡片

```
┌═════════════════════════════════════┐  ← 动画效果说明
│  ┏━━━━━┓                            │  ← 红色边框 (#ef4444)
│  ┃ 🛑  ┃  压缩机2出口温度            │  ← 风扇停止，颜色变淡
│  ┗━━━━━┛  Comp2 Out Temp           │  ← 传感器名称
│                                     │
│         92.0 °F                    │  ← 温度值（红色 #ef4444）
│         ↕️ 闪烁                     │  ← 1.5秒周期闪烁
│                                     │
│       ┌─────────────┐               │
│       │  ⚠  异常    │               │  ← 状态标签（红色背景）
│       └─────────────┘               │
└═════════════════════════════════════┘
    ↑ 淡红色渐变背景 (#fef2f2 → #ffffff)
    ↕️ 卡片整体呼吸动画（2秒周期）
```

## 动画效果详解

### 1. 风扇旋转动画（正常状态）

```
    🌀          🌀          🌀          🌀
   (0°)  →   (90°)  →  (180°)  →  (270°)  → (360°/0°)
    
    ↻ 持续旋转，2秒完成一圈
```

### 2. 温度值闪烁动画（异常状态）

```
  Opacity:  100%     70%      100%     70%      100%
            ████     ███      ████     ███      ████
            ↓        ↓        ↓        ↓        ↓
  Time:     0s      0.75s    1.5s     2.25s    3.0s
  
  ↺ 1.5秒一个周期，持续循环
```

### 3. 卡片呼吸动画（异常状态）

```
  Shadow:   ███      ██████   ███      ██████   ███
           (小)      (大)      (小)      (大)      (小)
            ↓        ↓        ↓        ↓        ↓
  Time:     0s       1s       2s       3s       4s
  
  ↺ 2秒一个周期，持续循环
```

## 颜色方案

### 正常状态配色
```
┌─────────────────────────────────────┐
│ 边框: #10b981 (绿色)                 │
│ 背景渐变: #f0fdf4 → #ffffff          │
│ 风扇背景: 紫色渐变 (#667eea → #764ba2)│
│ 温度值: #10b981 (绿色)               │
│ 标签背景: #10b981 (绿色)             │
└─────────────────────────────────────┘
```

### 异常状态配色
```
┌─────────────────────────────────────┐
│ 边框: #ef4444 (红色)                 │
│ 背景渐变: #fef2f2 → #ffffff          │
│ 风扇背景: 红色渐变 (#ef4444 → #dc2626)│
│ 温度值: #ef4444 (红色)               │
│ 标签背景: #ef4444 (红色)             │
└─────────────────────────────────────┘
```

## 响应式布局

### 超大屏幕 (≥1200px)
```
┌────────────────────────────────────────────────────────┐
│  [卡片1]      [卡片2]      [卡片3]      [卡片4]        │
│  25% 宽       25% 宽       25% 宽       25% 宽         │
└────────────────────────────────────────────────────────┘
```

### 大屏幕 (992px - 1199px)
```
┌────────────────────────────────────────────────────────┐
│  [卡片1]               [卡片2]                         │
│  50% 宽                50% 宽                          │
├────────────────────────────────────────────────────────┤
│  [卡片3]               [卡片4]                         │
│  50% 宽                50% 宽                          │
└────────────────────────────────────────────────────────┘
```

### 中屏幕 (768px - 991px)
```
┌────────────────────────────────────────────────────────┐
│  [卡片1]               [卡片2]                         │
│  50% 宽                50% 宽                          │
├────────────────────────────────────────────────────────┤
│  [卡片3]               [卡片4]                         │
│  50% 宽                50% 宽                          │
└────────────────────────────────────────────────────────┘
```

### 小屏幕 (<768px)
```
┌─────────────────────────┐
│      [卡片1]            │
│      100% 宽            │
├─────────────────────────┤
│      [卡片2]            │
│      100% 宽            │
├─────────────────────────┤
│      [卡片3]            │
│      100% 宽            │
├─────────────────────────┤
│      [卡片4]            │
│      100% 宽            │
└─────────────────────────┘
```

## 交互流程图

```
┌─────────────┐
│  页面加载    │
└──────┬──────┘
       │
       ▼
┌─────────────────────┐
│ 获取设备列表         │
│ (每2秒刷新一次)      │
└──────┬──────────────┘
       │
       ▼
┌─────────────────────┐
│ 查找 stm32_4 设备    │
└──────┬──────────────┘
       │
       ├─ 未找到 → 不显示温度监控模块
       │
       └─ 找到 ──────────────┐
                             │
                             ▼
                  ┌───────────────────────┐
                  │ 过滤4个温度传感器      │
                  └──────┬────────────────┘
                         │
                         ├─ 无数据 → 显示空模块
                         │
                         └─ 有数据 ────────┐
                                           │
                                           ▼
                              ┌────────────────────────┐
                              │ 渲染温度卡片            │
                              └──────┬─────────────────┘
                                     │
                     ┌───────────────┼───────────────┐
                     │               │               │
                     ▼               ▼               ▼
              ┌─────────────┐ ┌─────────────┐ ┌─────────────┐
              │ 判断温度值   │ │ 应用样式类   │ │ 启动动画     │
              └──────┬──────┘ └──────┬──────┘ └──────┬──────┘
                     │               │               │
                     │               │               │
           ┌─────────┴────────┐     │               │
           │                  │     │               │
           ▼                  ▼     ▼               ▼
    ┌─────────────┐    ┌─────────────────────────────┐
    │ < 85°F      │    │ ≥ 85°F                      │
    │ 正常状态     │    │ 异常状态                     │
    │ - 风扇旋转   │    │ - 风扇停止                   │
    │ - 绿色主题   │    │ - 红色主题                   │
    │ - 无闪烁     │    │ - 温度闪烁                   │
    └─────────────┘    │ - 卡片呼吸                   │
                       └─────────────────────────────┘
                                     │
                                     ▼
                       ┌─────────────────────────────┐
                       │ 每2秒重新获取数据            │
                       │ 更新显示                     │
                       └─────────────────────────────┘
```

## 组件层次结构

```
Dashboard.vue
│
├── 顶部横幅
│   └── Logo + 标题
│
├── 统计卡片区域
│   ├── 总设备数
│   ├── 在线设备
│   └── 离线设备
│
├── 搜索框
│
├── 【STM32_4 温度监控模块】 ← 新增
│   ├── 卡片头部
│   │   └── 标题: "stm32_4 - 温度监控"
│   │
│   └── 卡片主体
│       └── 温度卡片网格 (Row)
│           ├── 温度卡片1: comp1_in_temperature_F
│           │   ├── 头部
│           │   │   ├── 风扇图标
│           │   │   └── 传感器名称
│           │   ├── 温度值
│           │   └── 状态标签
│           │
│           ├── 温度卡片2: comp2_in_temperature_F
│           │   └── (同上结构)
│           │
│           ├── 温度卡片3: comp2_out_temperature_F
│           │   └── (同上结构)
│           │
│           └── 温度卡片4: comp1_out_temperature_F
│               └── (同上结构)
│
└── 设备数据卡片网格
    ├── 设备卡片1
    ├── 设备卡片2
    └── ...
```

## CSS 类名结构

```
.temperature-monitor-card          ← 主容器
  .card-header
    .bg-gradient-primary           ← 紫色渐变背景
  
  .card-body
    .temp-card                     ← 温度卡片
      .temp-normal                 ← 正常状态修饰符
      .temp-abnormal               ← 异常状态修饰符
      
      .temp-header                 ← 卡片头部
        .temp-icon-wrapper         ← 图标容器
          .temp-fan-icon           ← 风扇图标
            .fan-rotating          ← 旋转动画类
        
        .temp-label                ← 传感器名称
      
      .temp-value                  ← 温度数值
        .temp-danger               ← 异常状态修饰符
        .temp-unit                 ← 单位
      
      .temp-status                 ← 状态标签容器
        .badge
          .bg-success              ← 正常状态
          .bg-danger               ← 异常状态
```

## 数据流向图

```
MQTT Broker
    │
    │ (设备上报数据)
    ▼
Backend API
(/api/sensors/latest)
    │
    │ (HTTP GET)
    ▼
Dashboard.vue
(fetchDevicesWithSensors)
    │
    │ (数据处理)
    ├─→ devicesWithSensors[]      ← 所有设备数据
    │
    └─→ stm32Device               ← 过滤出 stm32_4
         │
         └─→ stm32TemperatureSensors[]  ← 过滤出4个温度传感器
              │
              ├─→ comp1_in_temperature_F
              ├─→ comp2_in_temperature_F  
              ├─→ comp2_out_temperature_F
              └─→ comp1_out_temperature_F
                   │
                   ▼
              isTempNormal()          ← 判断温度状态
                   │
                   ├─ true  → 正常状态渲染
                   └─ false → 异常状态渲染
```

## 时间轴示意

```
时间 ─────────────────────────────────────────────────────>

0s     2s     4s     6s     8s     10s
│      │      │      │      │      │
├──────┼──────┼──────┼──────┼──────┤  数据刷新 (每2秒)
│      │      │      │      │      │
├──┴──┴┴──┴──┴┴──┴──┴┴──┴──┴┴──┴──┤  风扇旋转 (持续，2秒一圈)
│      │      │      │      │      │
├──┴─┴──┴─┴──┴─┴──┴─┴──┴─┴──┴─┴──┤  温度闪烁 (异常时，1.5秒周期)
│      │      │      │      │      │
├────┴────┴────┴────┴────┴────┴──┤  卡片呼吸 (异常时，2秒周期)
```

## 性能指标

```
指标                    目标值            实际监测
─────────────────────────────────────────────
首次加载时间            < 3s              [测试中]
数据刷新延迟            < 500ms           [测试中]
动画帧率                60 FPS            [测试中]
内存占用                < 50MB            [测试中]
CPU 占用                < 5%              [测试中]
网络请求大小            < 100KB           [测试中]
```

## 浏览器兼容性

```
浏览器           版本要求    CSS动画    响应式布局
─────────────────────────────────────────
Chrome          ≥ 90        ✅         ✅
Firefox         ≥ 88        ✅         ✅
Safari          ≥ 14        ✅         ✅
Edge            ≥ 90        ✅         ✅
Opera           ≥ 76        ✅         ✅
Mobile Safari   ≥ 14        ✅         ✅
Chrome Mobile   ≥ 90        ✅         ✅
```
